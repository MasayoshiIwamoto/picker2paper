<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PhotoPickerApp — Google Photos → S3</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header>
      <h1>PhotoPickerApp</h1>
      <p>Google Photos から選んで S3 にアップロード</p>
    </header>

    <div id="signinOverlay" class="signin-overlay hidden">
      <div class="signin-panel">
        <h2>最初に Google にサインインしてください</h2>
        <p>サインイン後に写真の選択やアップロードが行えます。</p>
        <button id="overlaySignIn" class="primary">Google にサインイン</button>
      </div>
    </div>

    <main>
      <section class="controls">
        <div class="buttons">
          <button id="btnSignIn" class="primary">Google にサインイン</button>
          <button id="btnPick" disabled>Google フォトから選択</button>
          <button id="btnPickLocal" class="secondary" disabled>ローカルから選択</button>
          <button id="btnUpload" disabled>選択した写真をS3にアップロード</button>
        </div>
        <input id="inputLocalFiles" type="file" accept="image/*" multiple class="hidden" />
        <div class="auth">
          <div id="userInfo" class="small"></div>
        </div>
        <div id="popupHint" class="hint hidden">
          <strong>ポップアップがブロックされている可能性があります。</strong>
          <p id="popupHintMessage">ブラウザの設定でポップアップとサードパーティログインを許可してから、もう一度「写真を選択」を押してください。</p>
        </div>
      </section>

      <section>
        <h2>選択した写真</h2>
        <div id="selectedList" class="grid"></div>
      </section>

      <section class="uploads-section">
        <div class="section-header">
          <h2>S3 アップロード済み</h2>
          <div class="section-actions">
            <button id="btnRefreshUploads">一覧を表示</button>
            <button id="btnDeleteSelected" disabled>選択した写真を削除</button>
          </div>
        </div>
        <div id="uploadsContainer" class="uploads-container empty">
          <p id="uploadsEmpty" class="muted">一覧はまだ読み込まれていません。</p>
          <div id="uploadsList" class="uploads-list"></div>
          <button id="btnLoadMoreUploads" class="secondary hidden">さらに表示</button>
        </div>
      </section>

      <section>
        <h2>ログ</h2>
        <pre id="log" class="log"></pre>
      </section>
    </main>

    <!-- Config: must exist as config.js in production -->
    <script src="./config.js"></script>

    <!-- Google Identity Services -->
    <script async defer src="https://accounts.google.com/gsi/client"></script>

    <!-- App logic -->
    <script src="./main.js"></script>

  </body>
  </html>
